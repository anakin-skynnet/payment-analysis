import{c as J,j as e,U as oe,V as Y,l as ce,W as de,r as y,X as z,q as me,Y as pe,_ as xe,y as c,z as d,E as m,H as p,B as t,J as l,t as A,I as g,o as he,m as X,$ as ue,a0 as je}from"./index-BtVhH8KW.js";import{I as O}from"./input-DTJuHCRG.js";import{C as be}from"./circle-alert-CnGnDG1J.js";import{C as ge}from"./circle-check-DMA7zpyS.js";import{R as Z}from"./refresh-cw-DLr_UPYn.js";import{L as K}from"./layout-dashboard-CqYMxcHg.js";import{G as ee}from"./git-branch-D0wcVmNz.js";const fe=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],x=J("loader-circle",fe);const Ne=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],u=J("play",Ne);const ye=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],se=J("settings-2",ye),B="/api/setup";async function we(){const j=await fetch(`${B}/settings`,{credentials:"include"});if(!j.ok)throw new Error(await j.text());return j.json()}async function _e(){const j=await fetch(`${B}/defaults`,{credentials:"include"});if(!j.ok)throw new Error(await j.text());return j.json()}async function ke(j){const n=await fetch(`${B}/config`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(!n.ok){const I=await n.json().catch(()=>({detail:n.statusText}));throw new Error(I.detail||n.statusText)}return n.json()}function ve(){const j=oe(),{data:n,isLoading:I,refetch:M,isRefetching:v}=Y({queryKey:["setup","defaults"],queryFn:_e,staleTime:15e3,refetchOnWindowFocus:!0}),{data:C}=Y({queryKey:["setup","settings"],queryFn:we,staleTime:3e4}),{data:E}=ce({params:{}}),{data:L}=de({params:{limit:100}}),[$,F]=y.useState(""),[S,G]=y.useState(""),[R,q]=y.useState(""),[U,D]=y.useState(null),[W,N]=y.useState(null),[h,w]=y.useState(null);y.useEffect(()=>{n&&(F(n.warehouse_id),G(n.catalog),q(n.schema))},[n]);const P=z({mutationFn:ke,onSuccess:()=>{D({type:"config",message:"Catalog and schema saved. They will be used for all Lakehouse operations."}),N(null),j.invalidateQueries({queryKey:["setup","defaults"]})},onError:s=>{N(s.message),D(null)}}),ae=z({mutationFn:async s=>{const{data:r}=await ue({job_id:s.job_id,catalog:s.catalog??void 0,schema:s.schema??void 0,warehouse_id:s.warehouse_id??void 0});return r},onSuccess:s=>{N(null),s.run_page_url&&window.open(s.run_page_url,"_blank","noopener,noreferrer"),w(null)},onError:s=>{N(s.message),D(null),w(null)}}),ne=z({mutationFn:async s=>{const{data:r}=await je(s);return r},onSuccess:s=>{N(null),s.pipeline_page_url&&window.open(s.pipeline_page_url,"_blank","noopener,noreferrer"),w(null)},onError:s=>{N(s.message),D(null),w(null)}}),b=s=>{const r=n?.jobs?.[s];return!!r&&r!=="0"},te=()=>{P.mutate({catalog:S,schema:R})},T=n?.workspace_host||me(),a=T&&!T.includes("databricksapps")?pe(T):"",o=(n?.workspace_id||"").trim(),f=s=>{const r=n?.jobs?.[s];!a||!r||r==="0"||(w(s),N(null),ae.mutate({job_id:r,catalog:S||n?.catalog,schema:R||n?.schema,warehouse_id:$||n?.warehouse_id}))},i=s=>{if(!a)return;const r=n?.jobs?.[s];if(r&&r!=="0"){const k=o?`/jobs/${r}?o=${o}`:`/#job/${r}`;window.open(`${a}${k}`,"_blank","noopener,noreferrer")}else window.open(o?`${a}/jobs?o=${o}`:`${a}/jobs`,"_blank","noopener,noreferrer")},H=s=>{const r=n?.pipelines?.[s];!a||!r||r==="0"||(w(s),N(null),ne.mutate({pipeline_id:r}))},_=s=>{if(!a)return;const r=n?.pipelines?.[s],k=o?`?o=${o}`:"";r&&r!=="0"?window.open(`${a}/pipelines/${r}${k}`,"_blank","noopener,noreferrer"):window.open(`${a}/pipelines${k}`,"_blank","noopener,noreferrer")},Q=()=>{const s=$||n?.warehouse_id;if(!a||!s)return;const r=o?`?o=${o}`:"";window.open(`${a}/sql/warehouses/${s}${r}`,"_blank","noopener,noreferrer")},re=()=>{const s=S||n?.catalog,r=R||n?.schema;if(!a||!s||!r)return;const k=o?`?o=${o}`:"";window.open(`${a}/explore/data/${s}/${r}${k}`,"_blank","noopener,noreferrer")},ie=()=>{if(!a)return;const s=o?`?o=${o}`:"";window.open(`${a}/genie${s}`,"_blank","noopener,noreferrer")},V=()=>{if(!a)return;const s=o?`?o=${o}`:"";window.open(`${a}/jobs${s}`,"_blank","noopener,noreferrer")},le=()=>{if(!a)return;const s=o?`?o=${o}`:"";window.open(`${a}/pipelines${s}`,"_blank","noopener,noreferrer")};return I&&!n?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(x,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("h1",{className:"page-section-title text-2xl font-semibold",children:"Setup & Run"}),e.jsx(xe,{label:"Jobs & pipelines from workspace"})]}),e.jsxs("p",{className:"page-section-description",children:["Get the platform ready so your team can see approval rates and act on recommendations. Follow the steps in order; click ",e.jsx("strong",{children:"Run"})," to start a job or pipeline, or ",e.jsx("strong",{children:"Open"})," to view it in the workspace."]})]}),e.jsxs(c,{className:"border-primary/20 bg-primary/5",children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Connect to Databricks"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"To open jobs and pipelines in the Databricks workspace, use one of:"})]}),e.jsxs(p,{className:"text-sm space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"1. Your credentials (recommended):"})," Open this app from ",e.jsx("strong",{children:"Compute → Apps → payment-analysis"})," so Databricks forwards your token. No PAT needed when user authorization (OBO) is enabled for the app."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"2. Personal Access Token (PAT):"})," In the workspace go to ",e.jsx("strong",{children:"Settings → Developer → Access tokens"}),", create a token, then set ",e.jsx("code",{className:"rounded bg-muted px-1",children:"DATABRICKS_TOKEN"})," in ",e.jsx("strong",{children:"Compute → Apps → payment-analysis → Edit → Environment"}),". Also set ",e.jsx("code",{className:"rounded bg-muted px-1",children:"DATABRICKS_HOST"})," and ",e.jsx("code",{className:"rounded bg-muted px-1",children:"DATABRICKS_WAREHOUSE_ID"}),"."]}),e.jsxs("p",{className:"text-muted-foreground",children:["If you open the app from Compute → Apps (option 1), do ",e.jsx("strong",{children:"not"})," set ",e.jsx("code",{className:"rounded bg-muted px-1",children:"DATABRICKS_CLIENT_ID"})," or ",e.jsx("code",{className:"rounded bg-muted px-1",children:"DATABRICKS_CLIENT_SECRET"})," in the app environment."]}),a&&e.jsxs(t,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>window.open(o?`${a}/?o=${o}#setting/account`:`${a}/#setting/account`,"_blank","noopener,noreferrer"),children:["Open workspace Settings ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(m,{className:"text-base",children:"Databricks resources & approval-rate impact"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Resources used in this solution, why they are added, and how they help accelerate approval rates."})]}),e.jsx(p,{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"text-left py-2 pr-4 font-medium",children:"Resource"}),e.jsx("th",{className:"text-left py-2 pr-4 font-medium",children:"Purpose"}),e.jsx("th",{className:"text-left py-2 font-medium",children:"How it accelerates approval rates"})]})}),e.jsxs("tbody",{className:"[&_tr]:border-b [&_tr]:border-border",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"Transaction Stream Simulator"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Generate synthetic payment events at scale."}),e.jsx("td",{className:"py-2 align-top",children:"Stress-tests pipelines and decisioning; feeds analytics and ML training data."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"Lakeflow ETL pipeline"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Bronze → Silver → Gold data processing."}),e.jsx("td",{className:"py-2 align-top",children:"Clean, enriched data for KPIs, dashboards, and model training."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"Gold views (SQL)"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Analytical views for dashboards and Genie."}),e.jsx("td",{className:"py-2 align-top",children:"Visibility into approval rates, declines, and recovery opportunities."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"Lakehouse tables (approval_rules, recommendations, online_features)"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Store rules and ML/agent outputs in Unity Catalog."}),e.jsx("td",{className:"py-2 align-top",children:"Rules and similar-case recommendations feed real-time decisioning."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"ML models (approval propensity, risk, routing, retry)"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Train and register models in Unity Catalog."}),e.jsx("td",{className:"py-2 align-top",children:"Real-time scoring and routing to maximize approvals and reduce fraud."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"Model Serving"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Serve ML models with low-latency inference."}),e.jsx("td",{className:"py-2 align-top",children:"Sub-50ms approval/risk/routing predictions for live transactions."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"AI agents (Orchestrator, Smart Routing, Retry, Decline Analyst, etc.)"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Automate recommendations using ML and rules."}),e.jsx("td",{className:"py-2 align-top",children:"Suggest retries, routing, and 3DS use to recover declines and optimize flow."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"Vector Search"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Similar-transaction search over payment data."}),e.jsx("td",{className:"py-2 align-top",children:"“Similar cases” recommendations for retry and routing in the Decisioning UI."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"Dashboards (11)"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Monitor KPIs, declines, fraud, and performance."}),e.jsx("td",{className:"py-2 align-top",children:"Identify underperforming segments and act on recovery opportunities."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 align-top",children:"Unity Catalog"}),e.jsx("td",{className:"py-2 pr-4 align-top",children:"Governance, lineage, and schema for tables and models."}),e.jsx("td",{className:"py-2 align-top",children:"Secure, auditable data and models for compliance and trust."})]})]})]})})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"Parameters"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Catalog and schema are used for all Lakehouse operations (analytics, rules, ML). Save to persist them in the Lakehouse config table."})]}),e.jsxs(p,{className:"grid gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"warehouse_id",className:"text-sm font-medium leading-none",children:"SQL Warehouse ID"}),e.jsx(O,{id:"warehouse_id",value:$,onChange:s=>F(s.target.value),placeholder:"e.g. 148ccb90800933a1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"catalog",className:"text-sm font-medium leading-none",children:"Catalog"}),e.jsx(O,{id:"catalog",value:S,onChange:s=>G(s.target.value),placeholder:"ahs_demos_catalog"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"schema",className:"text-sm font-medium leading-none",children:"Schema"}),e.jsx(O,{id:"schema",value:R,onChange:s=>q(s.target.value),placeholder:"payment_analysis"})]}),e.jsx("div",{className:"sm:col-span-3 flex justify-end",children:e.jsxs(t,{onClick:te,disabled:P.isPending,children:[P.isPending?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):null,"Save catalog & schema"]})})]})]}),W&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-destructive/50 bg-destructive/10 px-4 py-3 text-sm text-destructive",children:[e.jsx(be,{className:"h-4 w-4 shrink-0"}),W]}),U&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-green-500/50 bg-green-500/10 px-4 py-3 text-sm text-green-700 dark:text-green-400",children:[e.jsx(ge,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{children:U.message})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Data & config"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"App settings (Lakebase), countries, and online features from the Databricks backend. Refreshed when you load or refocus this page."})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"App config & settings (Lakebase)"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Effective catalog and schema above are persisted in app_config. Key-value settings below are from app_settings (job defaults, warehouse_id)."}),e.jsx("div",{className:"overflow-x-auto rounded-md border border-border",children:e.jsxs("table",{className:"w-full text-sm border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border bg-muted/50",children:[e.jsx("th",{className:"text-left py-2 px-3 font-medium",children:"Key"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium",children:"Value"})]})}),e.jsxs("tbody",{className:"[&_tr]:border-b [&_tr]:border-border",children:[n&&e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3 font-medium text-muted-foreground",children:"catalog (effective)"}),e.jsx("td",{className:"py-2 px-3",children:n.catalog||"—"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3 font-medium text-muted-foreground",children:"schema (effective)"}),e.jsx("td",{className:"py-2 px-3",children:n.schema||"—"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3 font-medium text-muted-foreground",children:"warehouse_id"}),e.jsx("td",{className:"py-2 px-3",children:n.warehouse_id||"—"})]})]}),C?.settings&&Object.entries(C.settings).filter(([s])=>!["catalog","schema"].includes(s)||!n).map(([s,r])=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3 font-medium text-muted-foreground",children:s}),e.jsx("td",{className:"py-2 px-3 break-all",children:r||"—"})]},s)),(!C?.settings||Object.keys(C.settings).length===0)&&!n?.catalog&&!n?.schema&&!n?.warehouse_id&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"py-4 px-3 text-center text-muted-foreground text-sm",children:"No app settings loaded. Run Job 1 (Create Data Repositories) to seed Lakebase."})})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Countries / entities"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"From Lakehouse countries table (filter dropdown). Fetched from backend."}),e.jsx("div",{className:"overflow-x-auto rounded-md border border-border max-h-48 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm border-collapse",children:[e.jsx("thead",{className:"sticky top-0 bg-muted/50",children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"text-left py-2 px-3 font-medium",children:"Code"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium",children:"Name"})]})}),e.jsxs("tbody",{className:"[&_tr]:border-b [&_tr]:border-border",children:[(E?.data??[]).map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3",children:s.code}),e.jsx("td",{className:"py-2 px-3",children:s.name})]},s.code)),(!E?.data||E.data.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"py-4 px-3 text-center text-muted-foreground text-sm",children:"No countries. Run Job 1 to seed the Lakehouse."})})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Online features (last 100)"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"From Lakebase or Lakehouse. ML and AI agent outputs for the app."}),e.jsx("div",{className:"overflow-x-auto rounded-md border border-border max-h-64 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm border-collapse",children:[e.jsx("thead",{className:"sticky top-0 bg-muted/50",children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"text-left py-2 px-3 font-medium",children:"Source"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium",children:"Feature"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium",children:"Value"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium",children:"Entity"})]})}),e.jsxs("tbody",{className:"[&_tr]:border-b [&_tr]:border-border",children:[(L?.data??[]).map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3",children:s.source}),e.jsx("td",{className:"py-2 px-3",children:s.feature_name}),e.jsx("td",{className:"py-2 px-3",children:s.feature_value!=null?String(s.feature_value):s.feature_value_str??"—"}),e.jsx("td",{className:"py-2 px-3",children:s.entity_id??"—"})]},s.id+String(r))),(!L?.data||L.data.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 px-3 text-center text-muted-foreground text-sm",children:"No online features yet. ML and agents populate this after runs."})})]})]})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Execution steps (1–11)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Run in order. Jobs 1–7: Create repositories → Simulate events → Initialize ingestion → Deploy dashboards → Train models → Deploy agents → Genie sync (optional). Start Lakeflow pipelines when needed."}),n&&!a&&e.jsxs("p",{className:"text-sm text-amber-600 dark:text-amber-500",children:["Connect to Databricks: open this app from ",e.jsx("strong",{children:"Workspace → Compute → Apps → payment-analysis"})," so your token is forwarded (no env vars needed), or set ",e.jsx("code",{className:"rounded bg-muted px-1",children:"DATABRICKS_HOST"})," and ",e.jsx("code",{className:"rounded bg-muted px-1",children:"DATABRICKS_TOKEN"})," in the app environment."]}),n&&n.token_received===!1&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("p",{className:"text-sm text-amber-600 dark:text-amber-500 flex-1 min-w-0",children:["Token not received: enable ",e.jsx("strong",{children:"user authorization (on-behalf-of-user)"})," in ",e.jsx("strong",{children:"Compute → Apps → payment-analysis → Edit → Configure → Authorization"}),", add scopes (e.g. ",e.jsx("code",{className:"rounded bg-muted px-1",children:"sql"}),", ",e.jsx("code",{className:"rounded bg-muted px-1",children:"Jobs"}),", ",e.jsx("code",{className:"rounded bg-muted px-1",children:"Pipelines"}),"), then open this app again from ",e.jsx("strong",{children:"Compute → Apps"}),". Click ",e.jsx("strong",{children:"Refresh job IDs"})," after enabling."]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>M(),disabled:v,children:[v?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Refresh job IDs"]})]}),n&&n.token_received===!0&&n.workspace_url_derived===!1&&e.jsxs("p",{className:"text-sm text-amber-600 dark:text-amber-500",children:["Token received but workspace URL could not be derived. Set ",e.jsx("code",{className:"rounded bg-muted px-1",children:"DATABRICKS_HOST"})," in the app environment (Compute → Apps → Edit → Environment), or ensure you opened the app from the Apps URL (e.g. ",e.jsx("code",{className:"rounded bg-muted px-1",children:"payment-analysis-*.databricksapps.com"}),")."]}),n&&a&&(n.jobs?.lakehouse_bootstrap==="0"||!n.jobs?.lakehouse_bootstrap)&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex-1 min-w-0",children:[e.jsx("strong",{children:"Run"})," starts the job or pipeline and opens the run view in Databricks. It is enabled when the job or pipeline exists in your workspace (IDs are resolved when you are signed in). If Run is disabled, open this app from ",e.jsx("strong",{children:"Compute → Apps → payment-analysis"})," so Databricks forwards your token, then click ",e.jsx("strong",{children:"Refresh job IDs"})," below."]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>M(),disabled:v,children:[v?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Refresh job IDs"]})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>i("lakehouse_bootstrap"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&i("lakehouse_bootstrap"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"1. Lakehouse bootstrap"]}),e.jsx(g,{variant:"secondary",children:"Job"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Run once to create app_config, approval_rules, approval_recommendations, and online_features. Enables Rules, Decisioning, and Dashboard. Save catalog & schema above works after this (or table is created on first save)."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>f("lakehouse_bootstrap"),disabled:!a||!b("lakehouse_bootstrap"),children:[h==="lakehouse_bootstrap"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("lakehouse_bootstrap"),disabled:!a,children:["Open ",e.jsx(l,{className:"ml-1 h-3 w-3"})]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:Q,disabled:!a,children:["SQL Warehouse ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>i("vector_search_index"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&i("vector_search_index"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"2. Vector Search index"]}),e.jsx(g,{variant:"secondary",children:"Job"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create endpoint and delta-sync index from transaction_summaries_for_search. Powers similar-case recommendations in Decisioning. Run after Lakehouse Bootstrap."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>f("vector_search_index"),disabled:!a||!b("vector_search_index"),children:[h==="vector_search_index"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("vector_search_index"),disabled:!a,children:["Open ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>i("create_gold_views"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&i("create_gold_views"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"3. Create gold views (data repos)"]}),e.jsx(g,{variant:"secondary",children:"Job"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create 12+ analytical views for dashboards (v_executive_kpis, decline patterns, etc.). Uses warehouse and schema."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>f("create_gold_views"),disabled:!a||!b("create_gold_views"),children:[h==="create_gold_views"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("create_gold_views"),disabled:!a,children:["Open ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>i("transaction_stream_simulator"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&i("transaction_stream_simulator"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"4. Events producer (transaction simulator)"]}),e.jsx(g,{variant:"secondary",children:"Job"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Events simulator: generate test payment events (e.g. 1000/sec). Uses catalog and schema above."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>f("transaction_stream_simulator"),disabled:!a||!b("transaction_stream_simulator"),children:[h==="transaction_stream_simulator"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("transaction_stream_simulator"),disabled:!a,children:["Open ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>_("payment_realtime_pipeline"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&_("payment_realtime_pipeline"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"5. Optional: real-time streaming"]}),e.jsx(g,{variant:"outline",children:"Pipeline / Job"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Real-time Lakeflow pipeline and continuous stream processor for live payment events. Run when you need real-time analytics."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>H("payment_realtime_pipeline"),disabled:!a||!n?.pipelines?.payment_realtime_pipeline||n.pipelines.payment_realtime_pipeline==="0",children:[h==="payment_realtime_pipeline"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run (pipeline)"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>_("payment_realtime_pipeline"),disabled:!a,children:["Open pipeline ",e.jsx(l,{className:"ml-1 h-3 w-3"})]}),e.jsxs(t,{variant:"outline",onClick:()=>f("continuous_stream_processor"),disabled:!a||!b("continuous_stream_processor"),children:[h==="continuous_stream_processor"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run (stream processor)"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("continuous_stream_processor"),disabled:!a,children:["Open job ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>_("payment_analysis_etl"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&_("payment_analysis_etl"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"6. Ingestion & ETL (Lakeflow pipeline, Bronze → Silver → Gold)"]}),e.jsx(g,{variant:"secondary",children:"Pipeline"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ingestion Lakeflow pipeline: process raw data into silver and gold tables and feed Vector Search. Start a pipeline update."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>H("payment_analysis_etl"),disabled:!a||!n?.pipelines?.payment_analysis_etl||n.pipelines.payment_analysis_etl==="0",children:[h==="payment_analysis_etl"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>_("payment_analysis_etl"),disabled:!a,children:["Open ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>i("train_ml_models"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&i("train_ml_models"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"7. Train ML models"]}),e.jsx(g,{variant:"secondary",children:"Job"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Train approval propensity, risk scoring, routing, and retry models. Uses catalog and schema."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>f("train_ml_models"),disabled:!a||!b("train_ml_models"),children:[h==="train_ml_models"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("train_ml_models"),disabled:!a,children:["Open ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>i("orchestrator_agent"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&i("orchestrator_agent"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"9. Run AI orchestrator"]}),e.jsx(g,{variant:"secondary",children:"Job"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start the orchestrator to coordinate all AI agents (routing, retry, risk, decline, performance)."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>f("orchestrator_agent"),disabled:!a||!b("orchestrator_agent"),children:[h==="orchestrator_agent"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("orchestrator_agent"),disabled:!a,children:["Open ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"9b. Run specialist agents"]}),e.jsx(g,{variant:"secondary",children:"Jobs"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Run individual AI agents: Smart Routing, Smart Retry, Decline Analyst, Risk Assessor, Performance Recommender. Each uses the Lakehouse Rules when configured."})]}),e.jsx(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[{key:"smart_routing_agent",label:"Smart Routing"},{key:"smart_retry_agent",label:"Smart Retry"},{key:"decline_analyst_agent",label:"Decline Analyst"},{key:"risk_assessor_agent",label:"Risk Assessor"},{key:"performance_recommender_agent",label:"Performance Recommender"}].map(({key:s,label:r})=>e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsxs(t,{variant:"default",size:"sm",onClick:()=>f(s),disabled:!a||!b(s),title:`Run ${r} and open run view`,children:[h===s?e.jsx(x,{className:"h-3 w-3 animate-spin mr-1"}):e.jsx(u,{className:"h-3 w-3 mr-1"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i(s),disabled:!a,title:`Open ${r} job in Databricks workspace`,children:[r,e.jsx(l,{className:"ml-1 h-3 w-3"})]})]},s))})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>i("publish_dashboards"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&i("publish_dashboards"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"10. Update dashboards (publish for embed)"]}),e.jsx(g,{variant:"secondary",children:"Job"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Publish dashboards with embed credentials so the app can embed AI/BI dashboards. Run after bundle deploy or when you need to refresh published state."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>f("publish_dashboards"),disabled:!a||!b("publish_dashboards"),children:[h==="publish_dashboards"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("publish_dashboards"),disabled:!a,children:["Open ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]}),e.jsxs(c,{className:"card-interactive cursor-pointer",onClick:()=>i("genie_sync"),role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&i("genie_sync"),children:[e.jsxs(d,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"text-base flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"11. Genie space sync (optional)"]}),e.jsx(g,{variant:"secondary",children:"Job"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sync Genie space configuration and sample questions for natural language analytics over payment data."})]}),e.jsxs(p,{className:"flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs(t,{onClick:()=>f("genie_sync"),disabled:!a||!b("genie_sync"),children:[h==="genie_sync"?e.jsx(x,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(u,{className:"h-4 w-4 mr-2"}),"Run"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("genie_sync"),disabled:!a,children:["Open ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(m,{className:"text-base",children:"Quick links — open in Databricks"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"One-click to open jobs, pipelines, warehouse, Genie, and data explorer."})]}),e.jsxs(p,{className:"flex flex-wrap gap-2",children:[e.jsxs(t,{variant:"outline",size:"sm",onClick:V,disabled:!a,children:["Jobs ",e.jsx(l,{className:"ml-1 h-3 w-3"})]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:le,disabled:!a,children:["Pipelines ",e.jsx(l,{className:"ml-1 h-3 w-3"})]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:Q,disabled:!a,children:["SQL Warehouse ",e.jsx(l,{className:"ml-1 h-3 w-3"})]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:re,disabled:!a,children:["Explore schema ",e.jsx(l,{className:"ml-1 h-3 w-3"})]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:ie,disabled:!a,children:["Genie (Ask Data) ",e.jsx(l,{className:"ml-1 h-3 w-3"})]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("continuous_stream_processor"),disabled:!a,children:["Stream processor job ",e.jsx(l,{className:"ml-1 h-3 w-3"})]}),b("test_agent_framework")&&e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>i("test_agent_framework"),disabled:!a,children:["Test Agent Framework ",e.jsx(l,{className:"ml-1 h-3 w-3"})]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:V,disabled:!a,children:["All jobs ",e.jsx(l,{className:"ml-1 h-3 w-3"})]})]})]})]})}const Le=()=>e.jsx(ve,{});export{Le as component};
