import{j as e,k as y,V as N,ak as g,a2 as f,B as n,ad as v,J as l,n as w,y as c,z as m,E as x,H as h,I as C,L as p,A as u,N as j,K as k}from"./index-CxQcrJOo.js";import{T as b}from"./target-4fNQF0Ha.js";const D=async t=>{try{const o=await(await fetch(`/api/notebooks/notebooks/${t}/url`)).json();j(o?.url)}catch(a){console.error("Failed to open notebook:",a)}},r=()=>{j(k("/sql/dashboards/decline_analysis"))};function R(){const{entity:t}=y(),a=N({queryKey:["declines","summary"],queryFn:()=>g()}),{data:o}=f({params:{entity:t,limit:5}}),i=o?.data??[],d=a.data?.data??[];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold font-heading",children:"Declines"}),e.jsx("p",{className:"mt-1 text-sm font-medium text-primary",children:"Discover conditions and factors delaying approvals"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Decline patterns and recovery. Use Reason Codes for issuer vs reason heatmaps and remediation; use Smart Retry for approval with/without retry."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:r,children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Decline Dashboard",e.jsx(l,{className:"w-3 h-3 ml-2"})]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>D("gold_views_sql"),children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"SQL Views",e.jsx(l,{className:"w-3 h-3 ml-2"})]})]})]})}),e.jsxs(c,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:r,role:"button",tabIndex:0,onKeyDown:s=>s.key==="Enter"&&r(),children:[e.jsx(m,{children:e.jsx(x,{children:"Top decline buckets"})}),e.jsx(h,{className:"space-y-2",children:d.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No decline data yet. Post some `AuthorizationEvent`s via the Analytics API to populate this."}):d.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-mono text-sm",children:s.key}),e.jsx(C,{variant:"secondary",children:s.count})]},s.key))})]}),e.jsxs(c,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-primary"}),"Recommended actions to accelerate approvals"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Top conditions delaying approvals and what to do. From Reason Codes (Brazil). Apply these and use Decisioning for real-time auth/retry/routing."})]}),e.jsxs(h,{className:"space-y-3",children:[i.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No reason-code insights yet. Run gold views and open Reason Codes for full insights and recommended actions."}):e.jsx("ul",{className:"space-y-2",children:i.map(s=>e.jsxs("li",{className:"rounded-lg border border-border/60 p-2.5",children:[e.jsx("p",{className:"text-sm font-medium",children:s.decline_reason_standard}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:s.recommended_action})]},`${s.entry_system}-${s.decline_reason_standard}-${s.priority}`))}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsx(n,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(p,{to:"/reason-codes",children:["Reason Codes ",e.jsx(u,{className:"w-3 h-3 ml-1"})]})}),e.jsx(n,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(p,{to:"/decisioning",children:["Decisioning playground ",e.jsx(u,{className:"w-3 h-3 ml-1"})]})})]})]})]})]})}const A=()=>e.jsx(R,{});export{A as component};
