import{j as e,U as N,r as y,V as v,ag as k,X as l,ah as C,ai as w,aj as b,B as c,J as d,n as E,y as x,z as h,E as p,H as j,N as g,I as S,ac as q}from"./index-CxQcrJOo.js";import{I as F}from"./input-B4Jz6yEC.js";import{F as I}from"./flask-conical-BxeA9J1G.js";const u=async t=>{try{const a=await(await fetch(`/api/notebooks/notebooks/${t}/url`)).json();g(a?.url)}catch(n){console.error("Failed to open notebook:",n)}};function K(){const t=N(),[n,a]=y.useState("Routing bandit v0"),r=v({queryKey:["experiments"],queryFn:()=>k()}),i=l({mutationFn:()=>C({name:n}),onSuccess:()=>t.invalidateQueries({queryKey:["experiments"]})}),o=l({mutationFn:s=>w({experiment_id:s}),onSuccess:()=>t.invalidateQueries({queryKey:["experiments"]})}),f=l({mutationFn:s=>b({experiment_id:s}),onSuccess:()=>t.invalidateQueries({queryKey:["experiments"]})}),m=r.data?.data??[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Experiments"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>u("train_models"),children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"ML Training",e.jsx(d,{className:"w-3 h-3 ml-2"})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>u("agent_framework"),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Agent Tests",e.jsx(d,{className:"w-3 h-3 ml-2"})]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"A/B testing and routing experiments with MLflow tracking"})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(p,{children:"Create experiment"})}),e.jsxs(j,{className:"flex gap-2",children:[e.jsx(F,{value:n,onChange:s=>a(s.target.value)}),e.jsx(c,{onClick:()=>i.mutate(),disabled:i.isPending,children:"Create"})]})]}),e.jsx("div",{className:"space-y-3",children:m.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No experiments yet. Create one above."}):m.map(s=>e.jsx(L,{exp:s,onStart:()=>s.id&&o.mutate(s.id),onStop:()=>s.id&&f.mutate(s.id)},s.id??s.name))})]})}function L({exp:t,onStart:n,onStop:a}){const r=t.id??"",i=()=>g(q());return e.jsxs(x,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:i,role:"button",tabIndex:0,onKeyDown:o=>o.key==="Enter"&&i(),children:[e.jsxs(h,{className:"py-4",children:[e.jsxs(p,{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate",children:t.name}),e.jsx("div",{className:"text-xs text-muted-foreground font-mono truncate",children:r||"(no id)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:t.status==="running"?"default":"secondary",children:t.status}),e.jsx(d,{className:"h-4 w-4 text-muted-foreground shrink-0","aria-hidden":!0})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Click to open MLflow in Databricks"})]}),e.jsxs(j,{className:"flex gap-2",onClick:o=>o.stopPropagation(),children:[e.jsx(c,{variant:"secondary",onClick:n,disabled:!r||t.status==="running",children:"Start"}),e.jsx(c,{variant:"secondary",onClick:a,disabled:!r||t.status!=="running",children:"Stop"})]})]})}const z=()=>e.jsx(K,{});export{z as component};
